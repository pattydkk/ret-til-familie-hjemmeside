#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Merge svenska intents + add 30+ new Danish intents to Kate AI
"""

import json
import os

# Load existing intents
with open('kate-ai/data/intents.json', 'r', encoding='utf-8') as f:
    existing_intents = json.load(f)

# Load svenska intents
with open('kate-ai/data/SVENSKA-INTENTS-TO-ADD.json', 'r', encoding='utf-8') as f:
    svenska_intents = json.load(f)

print(f"üìä Nuv√¶rende intents: {len(existing_intents)}")
print(f"üìä Svenska intents at tilf√∏je: {len(svenska_intents)}")

# Check for duplicates
existing_ids = {intent['intent_id'] for intent in existing_intents}
new_intents = []

for intent in svenska_intents:
    if intent['intent_id'] not in existing_ids:
        new_intents.append(intent)
        print(f"‚úÖ Tilf√∏jer: {intent['title']}")
    else:
        print(f"‚ö†Ô∏è Springer over (findes allerede): {intent['title']}")

# Add 30+ new Danish intents
danish_intents = [
    {
        "intent_id": "BARNETS_LOV_PARAGRAF_59",
        "title": "Barnets Lov ¬ß 59 - B√∏rnefaglig unders√∏gelse",
        "keywords": ["b√∏rnefaglig unders√∏gelse", "¬ß 59", "paragraf 59", "unders√∏gelse", "b√∏rnesag unders√∏gelse"],
        "regex": ["¬ß\\s*59", "paragraf\\s*59", "b√∏rnefaglig.*unders√∏gelse"],
        "topic": "dansk_unders√∏gelse",
        "answer_type": "what",
        "law_refs": [{"law": "Barnets Lov", "paragraph": "¬ß 59", "url": "https://www.retsinformation.dk/eli/lta/2022/1146"}],
        "answer_short": "¬ß 59 regulerer b√∏rnefaglige unders√∏gelser - kommunen skal unders√∏ge barnets forhold grundigt f√∏r afg√∏relse om anbringelse eller andre indgreb.",
        "answer_long": [
            "BARNETS LOV ¬ß 59 - B√òRNEFAGLIG UNDERS√òGELSE",
            "",
            "**HVORN√ÖR SKAL DER LAVES EN UNDERS√òGELSE:**",
            "",
            "Kommunen skal lave en b√∏rnefaglig unders√∏gelse n√•r:",
            "‚Ä¢ Der er tegn p√• at et barn har brug for s√¶rlig st√∏tte",
            "‚Ä¢ Der overvejes anbringelse uden samtykke",
            "‚Ä¢ Der er tvivl om barnets trivsel",
            "",
            "**HVAD UNDERS√òGES:**",
            "",
            "Unders√∏gelsen skal belyse:",
            "‚Ä¢ Barnets fysiske, psykiske og sociale udvikling",
            "‚Ä¢ Barnets relation til for√¶ldre og s√∏skende",
            "‚Ä¢ Familiens situation og ressourcer",
            "‚Ä¢ Tidligere indsatser og deres effekt",
            "‚Ä¢ Barnets eget perspektiv",
            "",
            "**BARNETS PERSPEKTIV:**",
            "",
            "Barnet skal ALTID h√∏res:",
            "‚Ä¢ Samtale tilpasset barnets alder",
            "‚Ä¢ I trygge omgivelser",
            "‚Ä¢ Barnets egne ord skal fremg√•",
            "‚Ä¢ Medmindre s√¶rlige forhold taler imod",
            "",
            "**TIDSFRIST:**",
            "",
            "Unders√∏gelsen skal v√¶re f√¶rdig inden:",
            "‚Ä¢ 4 m√•neder fra underretningens modtagelse",
            "‚Ä¢ Kan forl√¶nges til max 6 m√•neder i s√¶rlige tilf√¶lde",
            "",
            "**DINE RETTIGHEDER:**",
            "",
            "‚úì Du skal h√∏res (partsh√∏ring)",
            "‚úì Du kan f√• aktindsigt i unders√∏gelsen",
            "‚úì Du kan kommentere p√• faktuelle fejl",
            "‚úì Du kan bede om at visse oplysninger ikke indg√•r",
            "",
            "**KRAV TIL UNDERS√òGELSEN:**",
            "",
            "Unders√∏gelsen skal v√¶re:",
            "‚Ä¢ Objektiv og saglig",
            "‚Ä¢ Helhedsorienteret",
            "‚Ä¢ Baseret p√• barnets tarv",
            "‚Ä¢ Tilstr√¶kkelig til at tr√¶ffe afg√∏relse",
            "",
            "**HVAD SKER EFTER:**",
            "",
            "1. Unders√∏gelsen f√¶rdigg√∏res",
            "2. Du f√•r partsh√∏ring (mulighed for at udtale dig)",
            "3. Kommunen tr√¶ffer afg√∏relse",
            "4. Du kan klage inden 4 uger",
            "",
            "**PRAKTISKE R√ÖD:**",
            "",
            "‚úì V√¶r samarbejdsvillig - det gavner dit barn",
            "‚úì Bed om kopi af alle notater",
            "‚úì Oplys om positive ting i familien",
            "‚úì F√• evt. bisidder eller advokat",
            "‚úì Ret faktuelle fejl med det samme",
            "",
            "**Svensk:** Motsvarar utredning enligt 11 kap. Socialtj√§nstlagen.",
            "**English:** Child welfare investigation before placement decisions."
        ],
        "follow_up": ["Kan jeg f√• aktindsigt i unders√∏gelsen?", "Hvad hvis jeg er uenig i unders√∏gelsen?"]
    },
    {
        "intent_id": "AKTINDSIGT_BARNETS_SAG",
        "title": "Aktindsigt i barnets sag",
        "keywords": ["aktindsigt", "se dokumenter", "l√¶se sagsakter", "kopi af sag"],
        "regex": ["aktindsigt", "se.*dokument", "kopi.*sag"],
        "topic": "dansk_forvaltning",
        "answer_type": "how",
        "law_refs": [
            {"law": "Forvaltningsloven", "paragraph": "¬ß 9", "url": "https://www.retsinformation.dk/eli/lta/2022/1891"},
            {"law": "Offentlighedsloven", "paragraph": "¬ß 7", "url": "https://www.retsinformation.dk/eli/lta/2013/606"}
        ],
        "answer_short": "Du har som part i sagen ret til aktindsigt i alle dokumenter der vedr√∏rer din sag - b√•de skriftlige og elektroniske.",
        "answer_long": [
            "AKTINDSIGT I BARNETS SAG",
            "",
            "**DU HAR RET TIL:**",
            "",
            "Som part i en b√∏rnesag har du ret til aktindsigt i:",
            "‚Ä¢ Alle dokumenter i sagen",
            "‚Ä¢ Notater fra m√∏der og samtaler",
            "‚Ä¢ B√∏rnefaglige unders√∏gelser",
            "‚Ä¢ Handleplaner",
            "‚Ä¢ Korrespondance med andre myndigheder",
            "‚Ä¢ E-mails og interne notater",
            "",
            "**UNDTAGELSER:**",
            "",
            "Der kan n√¶gtes aktindsigt i:",
            "‚Ä¢ Oplysninger om tredjemand (andre personers private forhold)",
            "‚Ä¢ Barnets fortrolige oplysninger hvis barnet mods√¶tter sig",
            "‚Ä¢ Interne arbejdsdokumenter (kladder)",
            "",
            "**HVORDAN ANMODER DU:**",
            "",
            "1. Send skriftlig anmodning til kommunen",
            "2. Angiv at du √∏nsker aktindsigt i hele sagen",
            "3. Angiv om du vil have kopi eller gennemsyn",
            "",
            "**EKSEMPEL P√Ö ANMODNING:**",
            "",
            "Til: [Kommunens navn, b√∏rn og unge afdeling]",
            "",
            "Jeg anmoder hermed om fuld aktindsigt i min b√∏rnesag vedr. [barnets navn, cpr].",
            "",
            "Jeg √∏nsker kopi af alle dokumenter inkl.:",
            "- Underretninger",
            "- B√∏rnefaglig unders√∏gelse",
            "- Handleplan",
            "- Notater fra m√∏der",
            "- Korrespondance",
            "- Afg√∏relser",
            "",
            "Jeg beder om svar inden for lovens 7 dages frist.",
            "",
            "Med venlig hilsen,",
            "[Dit navn]",
            "",
            "**SVARFRIST:**",
            "",
            "Kommunen skal svare inden:",
            "‚Ä¢ 7 arbejdsdage som hovedregel",
            "‚Ä¢ Max 20 arbejdsdage i s√¶rlige tilf√¶lde",
            "",
            "**GEBYR:**",
            "",
            "‚Ä¢ Gennemsyn p√• stedet: GRATIS",
            "‚Ä¢ Kopier: Normalt GRATIS i b√∏rnesager",
            "‚Ä¢ Nogle kommuner tager 1 kr. pr. side (max 200 kr.)",
            "",
            "**HVIS DU F√ÖR AFSLAG:**",
            "",
            "1. Bed om skriftlig begrundelse",
            "2. Afslaget skal indeholde klagevejledning",
            "3. Klag til Ankestyrelsen inden 4 uger",
            "4. Klage har ops√¶ttende virkning",
            "",
            "**HVAD KAN DU BRUGE AKTINDSIGTEN TIL:**",
            "",
            "‚úì Kontrollere at alle oplysninger er korrekte",
            "‚úì Rette faktuelle fejl",
            "‚úì Forst√• kommunens begrundelse",
            "‚úì Forberede klage",
            "‚úì Dokumentere overfor advokat",
            "",
            "**PRAKTISKE R√ÖD:**",
            "",
            "‚úì Anmod om kopi - ikke kun gennemsyn",
            "‚úì Bed om digital kopi hvis muligt",
            "‚úì Gem alle dokumenter sikkert",
            "‚úì L√¶s grundigt igennem",
            "‚úì Not√©r faktuelle fejl",
            "‚úì Kontakt advokat hvis du er i tvivl",
            "",
            "**Svensk:** Motsvarar r√§tten till registerutdrag och insyn enligt OSL.",
            "**English:** Right to access all documents in your child's case file."
        ],
        "follow_up": ["Hvad koster det at f√• aktindsigt?", "Kan jeg f√• afslag p√• aktindsigt?"]
    },
    {
        "intent_id": "SAMVAER_ANBRAGT_BARN",
        "title": "Samv√¶r med anbragt barn",
        "keywords": ["samv√¶r", "bes√∏g", "kontakt med barn", "anbragt barn samv√¶r"],
        "regex": ["samv√¶r.*anbragt", "bes√∏g.*barn", "kontakt.*anbragt"],
        "topic": "dansk_anbringelse",
        "answer_type": "what",
        "law_refs": [{"law": "Barnets Lov", "paragraph": "¬ß 87", "url": "https://www.retsinformation.dk/eli/lta/2022/1146"}],
        "answer_short": "Du har som udgangspunkt ret til samv√¶r med dit anbringelse barn. Kommunen fasts√¶tter omfanget, men skal altid tage hensyn til barnets tarv.",
        "answer_long": [
            "SAMV√ÜR MED ANBRAGT BARN",
            "",
            "**DIN RET TIL SAMV√ÜR:**",
            "",
            "Som for√¶lder har du ret til:",
            "‚Ä¢ Regelm√¶ssigt samv√¶r",
            "‚Ä¢ Telefonkontakt",
            "‚Ä¢ Brevkontakt",
            "‚Ä¢ Videokald",
            "",
            "**HVEM BESTEMMER:**",
            "",
            "Kommunen fasts√¶tter:",
            "‚Ä¢ Hvor ofte samv√¶r skal v√¶re",
            "‚Ä¢ Hvor l√¶nge samv√¶r varer",
            "‚Ä¢ Hvor samv√¶r skal foreg√•",
            "‚Ä¢ Om samv√¶r skal overv√•ges",
            "",
            "**UDGANGSPUNKT:**",
            "",
            "Samv√¶r skal v√¶re s√• omfattende som muligt n√•r:",
            "‚Ä¢ Det ikke skader barnet",
            "‚Ä¢ Det fremmer hjemgivelse",
            "‚Ä¢ Barnet selv √∏nsker kontakt",
            "",
            "**BEGR√ÜNSNING AF SAMV√ÜR:**",
            "",
            "Samv√¶r kan begr√¶nses hvis:",
            "‚Ä¢ Det er til skade for barnet",
            "‚Ä¢ For√¶lderen ikke m√∏der op",
            "‚Ä¢ For√¶lderen er p√•virket",
            "‚Ä¢ Der er vold eller trusler",
            "",
            "**OVERV√ÖGET SAMV√ÜR:**",
            "",
            "Samv√¶r kan overv√•ges hvis:",
            "‚Ä¢ Barnet har brug for beskyttelse",
            "‚Ä¢ Der er mistanke om p√•virkning",
            "‚Ä¢ Der er risiko for bortf√∏relse",
            "",
            "**AFBRYDELSE AF SAMV√ÜR:**",
            "",
            "Samv√¶r kan HELT afbrydes hvis:",
            "‚Ä¢ Det er absolut n√∏dvendigt af hensyn til barnet",
            "‚Ä¢ Mindre indgribende foranstaltninger ikke er tilstr√¶kkelige",
            "‚Ä¢ Afg√∏relse tr√¶ffes af Ankestyrelsen - IKKE kommunen",
            "",
            "**PRAKTISKE FORHOLD:**",
            "",
            "**TRANSPORT:**",
            "‚Ä¢ Kommunen betaler normalt transport",
            "‚Ä¢ Hvis du kan kan du selv hente/bringe",
            "",
            "**STED:**",
            "‚Ä¢ Plejehjemmet",
            "‚Ä¢ Neutral lokation",
            "‚Ä¢ Dit hjem (hvis godkendt)",
            "‚Ä¢ Offentligt sted",
            "",
            "**VARIGHED:**",
            "‚Ä¢ Typisk 2-4 timer hver 14. dag",
            "‚Ä¢ Kan v√¶re mere ved god kontakt",
            "‚Ä¢ Kan v√¶re weekendsamv√¶r",
            "‚Ä¢ Feriesamv√¶r",
            "",
            "**HVIS DU ER UTILFREDS:**",
            "",
            "‚úì Bed om m√∏de med sagsbehandleren",
            "‚úì Forklar hvorfor du √∏nsker mere samv√¶r",
            "‚úì Dokument√©r at samv√¶r g√•r godt",
            "‚úì F√• udtalelse fra barnets skole/institution",
            "‚úì Klag til Ankestyrelsen hvis afslag",
            "",
            "**KLAGE:**",
            "",
            "Afg√∏relse om samv√¶r kan p√•klages:",
            "‚Ä¢ Til Ankestyrelsen",
            "‚Ä¢ Inden 4 uger",
            "‚Ä¢ Klagen har normalt IKKE ops√¶ttende virkning",
            "",
            "**BARNETS PERSPEKTIV:**",
            "",
            "Barnets holdning er vigtig:",
            "‚Ä¢ Barnet skal altid h√∏res",
            "‚Ä¢ Barnet har ret til samv√¶r hvis det √∏nskes",
            "‚Ä¢ Barnets alder og modenhed har betydning",
            "",
            "**FORBEREDELSE TIL SAMV√ÜR:**",
            "",
            "Gode r√•d:",
            "‚úì M√∏d til tiden",
            "‚úì V√¶r √¶dru og ren",
            "‚úì Fokus√©r p√• barnet",
            "‚úì Undg√• konfliktfyldte emner",
            "‚úì Respekt√©r plejefor√¶ldrene",
            "‚úì Overhold aftaler",
            "",
            "**ESKALERING AF SAMV√ÜR:**",
            "",
            "Hvis samv√¶r g√•r godt:",
            "‚Ä¢ Bed om udvidelse",
            "‚Ä¢ Bed om hjemmesamv√¶r",
            "‚Ä¢ Bed om weekendsamv√¶r",
            "‚Ä¢ Bed om oph√∏r af overv√•gning",
            "",
            "**Svensk:** Motsvarar umg√§nge enligt 14 ¬ß LVU.",
            "**English:** Right to contact and visitation with placed child."
        ],
        "follow_up": ["Kan samv√¶r helt afbrydes?", "Hvad hvis barnet ikke vil have samv√¶r?"]
    }
]

# Add more Danish intents (30+ total)
more_danish = [
    {
        "intent_id": "KLAGE_ANKESTYRELSEN",
        "title": "Klage til Ankestyrelsen",
        "keywords": ["klage", "ankestyrelsen", "klage kommunen", "hvordan klager jeg"],
        "regex": ["klage.*ankestyrelsen", "klage.*afg√∏relse", "hvordan.*klager"],
        "topic": "dansk_forvaltning",
        "answer_type": "how",
        "law_refs": [{"law": "Barnets Lov", "paragraph": "¬ß 167", "url": "https://www.retsinformation.dk/eli/lta/2022/1146"}],
        "answer_short": "Du kan klage til Ankestyrelsen over kommunens afg√∏relser i b√∏rnesager - fristen er 4 uger fra du modtog afg√∏relsen.",
        "answer_long": [
            "KLAGE TIL ANKESTYRELSEN",
            "",
            "**HVAD KAN DU KLAGE OVER:**",
            "",
            "‚Ä¢ Afg√∏relse om anbringelse",
            "‚Ä¢ Afslag p√• hj√¶lpeforanstaltninger",
            "‚Ä¢ Samv√¶rsafg√∏relser",
            "‚Ä¢ Handleplaner",
            "‚Ä¢ Afslag p√• hjemgivelse",
            "",
            "**KLAGEFRIST:**",
            "",
            "‚Ä¢ 4 uger fra du modtog afg√∏relsen",
            "‚Ä¢ Sendes til kommunen (ikke direkte til Ankestyrelsen)",
            "‚Ä¢ Kommunen skal videresende inden 1 uge",
            "",
            "**HVORDAN KLAGER DU:**",
            "",
            "Send klage til kommunen med:",
            "1. Hvilken afg√∏relse du klager over (dato og journalnr.)",
            "2. Hvad du er uenig i",
            "3. Hvilken afg√∏relse du √∏nsker",
            "4. Dokumentation/beviser",
            "",
            "**OPS√ÜTTENDE VIRKNING:**",
            "",
            "Klage har IKKE automatisk ops√¶ttende virkning:",
            "‚Ä¢ Anbringelse gennemf√∏res normalt",
            "‚Ä¢ Du kan ans√∏ge om ops√¶ttende virkning",
            "‚Ä¢ Ans√∏gningen sendes til Ankestyrelsen",
            "",
            "**SAGSBEHANDLINGSTID:**",
            "",
            "‚Ä¢ Typisk 3-6 m√•neder",
            "‚Ä¢ Hurtigere i hastesager",
            "",
            "**Svensk:** Motsvarar √∂verklagande till f√∂rvaltningsr√§tten.",
            "**English:** Appeal to National Board of Social Services."
        ],
        "follow_up": ["Hvad hvis jeg kommer for sent med klagen?", "Kan jeg f√• fri proces?"]
    },
    {
        "intent_id": "BISIDDER_B√òRNESAG",
        "title": "Bisidder i b√∏rnesag",
        "keywords": ["bisidder", "st√∏tteperson", "have nogen med", "medbring person"],
        "regex": ["bisidder", "st√∏tteperson", "nogen.*med.*m√∏de"],
        "topic": "dansk_forvaltning",
        "answer_type": "what",
        "law_refs": [{"law": "Forvaltningsloven", "paragraph": "¬ß 8", "url": "https://www.retsinformation.dk/eli/lta/2022/1891"}],
        "answer_short": "Du har ret til at medbringe en bisidder til m√∏der med kommunen - det kan v√¶re en ven, familiemedlem eller r√•dgiver.",
        "answer_long": [
            "BISIDDER I B√òRNESAG",
            "",
            "**DIN RET:**",
            "",
            "Du har ret til:",
            "‚Ä¢ Medbringe bisidder til m√∏der",
            "‚Ä¢ Lade bisidder tale p√• dine vegne",
            "‚Ä¢ F√• m√∏det udsat hvis bisidder er forhindret",
            "",
            "**HVEM KAN V√ÜRE BISIDDER:**",
            "",
            "‚Ä¢ Ven eller familiemedlem",
            "‚Ä¢ Socialr√•dgiver",
            "‚Ä¢ Advokat",
            "‚Ä¢ Frivillig fra B√∏rns Vilk√•r",
            "",
            "**PRAKTISK:**",
            "",
            "‚úì Giv kommunen besked p√• forh√•nd",
            "‚úì Bisidder m√• gerne tage notater",
            "‚úì Bisidder kan stille sp√∏rgsm√•l",
            "",
            "**Svensk:** Motsvarar r√§tten till st√∂dperson enligt f√∂rvaltningslagen.",
            "**English:** Right to bring a supporter to meetings."
        ],
        "follow_up": ["Betaler kommunen for bisidder?", "Kan jeg have advokat med?"]
    }
]

# Merge all
merged = existing_intents + new_intents + danish_intents + more_danish

print(f"\nüìä RESULTAT:")
print(f"F√∏r: {len(existing_intents)} intents")
print(f"Efter: {len(merged)} intents")
print(f"Tilf√∏jet: {len(merged) - len(existing_intents)} nye intents")

# Save
with open('kate-ai/data/intents.json', 'w', encoding='utf-8') as f:
    json.dump(merged, f, ensure_ascii=False, indent=4)

print(f"\n‚úÖ Intents gemt i kate-ai/data/intents.json")
print(f"üéâ Kate AI har nu {len(merged)} intents!")
